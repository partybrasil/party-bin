{% extends 'base.html' %}
{% block title %}Dashboard | PartyBin{% endblock %}
{% block content %}
<h2>Dashboard de Pastes</h2>
{% if not pastes %}
<form method="POST" action="/dashboard">
    <label>Clave secreta: <input type="password" name="secret_key"></label>
    <button type="submit">Acceder</button>
</form>
{% else %}
<div class="admin-actions" style="margin-bottom:20px;">
    <form method="POST" action="/dashboard/logout" style="display:inline;">
        <button type="submit">Cerrar sesión</button>
    </form>
    <form method="POST" action="/dashboard/delete_all" style="display:inline;" onsubmit="return confirm('¿Seguro que quieres eliminar TODOS los pastes?');">
        <button type="submit" style="background:#c00;color:#fff;">Eliminar todos los pastes</button>
    </form>
    <form method="POST" action="/dashboard/export_all" style="display:inline;">
        <button type="submit">Exportar todos los pastes (.zip)</button>
    </form>
</div>
<table>
    <tr><th>Título</th><th>URL</th><th>Vistas</th><th>Expira</th><th>Acciones</th></tr>
    {% for paste in pastes %}
    <tr>
        <td>{{ paste.title }}</td>
        <td><a href="/view/{{ paste.url }}">{{ paste.url }}</a></td>
        <td>{{ paste.views }}</td>
        <td>{{ paste.expiration or 'Nunca' }}</td>
        <td>
            <a href="/edit/{{ paste.url }}">Editar</a>
            <form method="POST" action="/delete/{{ paste.url }}" style="display:inline;" onsubmit="return confirm('¿Eliminar este paste?');">
                <button type="submit" style="background:#c00;color:#fff;">Eliminar</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% endif %}
{% endblock %}
